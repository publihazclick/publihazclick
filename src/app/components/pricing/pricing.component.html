<section class="py-8 md:py-12 bg-black text-white px-4 md:px-6">
  <div class="max-w-6xl mx-auto text-center">
    <h2 class="text-3xl md:text-5xl font-black mb-3 tracking-tighter uppercase leading-none">
      <span class="text-cyan-500">Paquetes</span> & Precios
    </h2>
    <p class="text-gray-500 uppercase tracking-widest text-[10px] font-bold mb-8 md:mb-12">Elige el plan perfecto para ti</p>

    @if (loading()) {
      <div class="flex justify-center items-center py-16">
        <div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-cyan-500"></div>
      </div>
    } @else if (error()) {
      <div class="bg-red-500/10 border border-red-500 rounded-lg p-5 max-w-md mx-auto">
        <p class="text-red-500 text-sm">{{ error() }}</p>
        <button
          (click)="loadPackages()"
          class="mt-3 px-5 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-bold text-sm"
        >
          Reintentar
        </button>
      </div>
    } @else {
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 items-stretch">
        @for (pkg of packages(); track pkg.id) {
          <div
            class="rounded-2xl p-4 md:p-5 text-left relative overflow-hidden group transition-all duration-300 md:hover:scale-[1.03] flex flex-col"
            [class]="isPopularPackage(pkg.package_type)
              ? 'bg-gradient-to-b from-slate-900 to-slate-800 border-2 border-cyan-500 shadow-[0_0_30px_rgba(0,229,255,0.12)]'
              : 'bg-[#111] border border-white/10 hover:border-white/20'"
          >
            <!-- Badge recomendado -->
            @if (isPopularPackage(pkg.package_type)) {
              <div class="absolute top-0 left-0 right-0 bg-cyan-500 text-black text-[9px] font-black uppercase py-0.5 tracking-widest text-center">
                Recomendado
              </div>
            }

            <!-- Header: icono + tipo -->
            <div class="flex items-center gap-2 mb-4" [class.mt-3]="isPopularPackage(pkg.package_type)">
              <div class="w-8 h-8 rounded-lg flex items-center justify-center"
                [class]="isPopularPackage(pkg.package_type) ? 'bg-cyan-500/20' : 'bg-white/5'">
                <span class="material-symbols-outlined text-base"
                  [class]="isPopularPackage(pkg.package_type) ? 'text-cyan-400' : 'text-gray-400'">
                  @switch (pkg.package_type) {
                    @case ('basic') { star }
                    @case ('premium') { auto_awesome }
                    @case ('enterprise') { speed }
                    @case ('custom') { workspace_premium }
                    @default { card_membership }
                  }
                </span>
              </div>
              <span class="font-bold text-[9px] uppercase tracking-widest"
                [class]="isPopularPackage(pkg.package_type) ? 'text-cyan-400' : 'text-gray-500'">
                {{ getPackageTypeLabel(pkg.package_type) }}
              </span>
            </div>

            <!-- Nombre + Precio -->
            <div class="mb-3">
              <h3 class="text-lg font-black tracking-tight mb-1"
                [class]="isPopularPackage(pkg.package_type) ? 'text-white' : 'text-white'">
                {{ pkg.name }}
              </h3>
              <div class="flex items-baseline gap-1">
                <span class="text-2xl md:text-3xl font-black tracking-tighter text-white">
                  {{ getPriceDisplay(pkg.price, pkg.currency) }}
                </span>
                <span class="text-[10px] font-bold text-gray-500">/ {{ pkg.duration_days }} días</span>
              </div>
            </div>

            <!-- Descripción -->
            <p class="text-[11px] text-gray-400 mb-3 leading-relaxed line-clamp-2">{{ pkg.description }}</p>

            <!-- Separador -->
            <div class="h-px w-full mb-3"
              [class]="isPopularPackage(pkg.package_type) ? 'bg-cyan-500/20' : 'bg-white/5'"></div>

            <!-- Features -->
            <ul class="space-y-1.5 mb-4 flex-1">
              @for (feature of getFeaturesList(pkg.features); track feature) {
                <li class="flex items-start gap-2 text-[11px] font-medium"
                  [class]="isPopularPackage(pkg.package_type) ? 'text-gray-300' : 'text-gray-400'">
                  <span class="material-symbols-outlined text-cyan-500 flex-shrink-0" style="font-size:14px">check</span>
                  <span>{{ feature }}</span>
                </li>
              }
            </ul>

          </div>
        }
      </div>

      @if (packages().length === 0) {
        <div class="text-center py-10">
          <span class="material-symbols-outlined text-5xl text-gray-600 mb-3">inventory_2</span>
          <p class="text-gray-500 text-sm">No hay paquetes disponibles en este momento</p>
        </div>
      }
    }
  </div>
</section>
